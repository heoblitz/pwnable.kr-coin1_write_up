#!/usr/bin/python2.7

from pwn import *
import time
import re

def chr_range(x, y):
	range_value = range(x, y)
	a = 0
	for i in range_value:
		range_value[a] = str(i)
		a += 1
	data = " ".join(range_value)
	return data

p = remote("pwnable.kr", 9007)
print(p.recv())
time.sleep(3)

j = 0

while(j<100):
	recv_data = p.recvline()
	print(recv_data)
	value = re.findall('[0-9]+', recv_data)

	number = int(value[0])
	chance = int(value[1])

	start = 0
	offset = number/2 + 1
	end = number
	save_end = number

	for i in range(0, chance+1):
		data = chr_range(start, offset)
		p.sendline(data)
		print("input data : %s"%data)
		
		if(i == chance):
			break

		value = int(p.recvline())
		print("answer : %d"%value)
		print("s:%d o:%d e:%d\n\n"%(start, offset, end))
		
		if(value == 9):
			continue
		elif(value == 10):
			start += 1
			offset += 1	
		elif(value%10 == 9):
			end = offset
			offset = (end-start)/2+start
		else:
			start = offset 
			offset = (end-start)/2+start
	j += 1		
	print(p.recv())

print(p.recv())


